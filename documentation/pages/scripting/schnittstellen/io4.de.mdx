---
title: "Selektion von Punkten, Objekten, Bereichen"
page: true
---
## Befehle, damit der Anwender Objekte selektiert oder ein Fenster aufzieht

###  Punktselektion
Das Attribut  <Italic> Application.IO </Italic>  erm&#246;glicht auch die Abfrage von Koordinaten vom Anwender unter Angabe einer Eingabeaufforderung.
&#220;ber die Eigenschaft  <Bold> .Ok </Bold>  des Ergebnisses kann gepr&#252;ft werden, ob die Eingabe erfolgreich durchgef&#252;hrt wurde.
Bei erfolgreicher Eingabe kann mittels  <Bold> .Value </Bold>  auf die Koordinate in Form eines  <Bold> Tuples </Bold>  zugegriffen werden.

```
rslt = Application.IO.GetPoint(&quot;Punkt zeigen:&quot;)
   if rslt.Ok:
       print rslt.Value
```


Wahlweise kann mit der Methode auch eine Geometrie &#252;bergeben werden, welche dann an der Maus h&#228;ngt (geom), und es kann der Objektfang ein- oder ausgeschaltet werden (snap = True, False)

```

geom = [(-25,-25), (25,-25), (25,25), (-25,25), (-25,-25)]
snap=False
Application.IO.GetPoint(&#39;Druckbereich positionieren&#39;, geom, snap) 

```


### Objektselektion
Das Attribut  <Italic> Application.IO </Italic>  erm&#246;glicht auch die Abfrage von Grafikobjekten vom Anwender unter Angabe einer Eingabeaufforderung.
&#220;ber die Eigenschaft  <Bold> .Ok </Bold>  des Ergebnisses kann gepr&#252;ft werden, ob die Eingabe erfolgreich durchgef&#252;hrt wurde.
Bei erfolgreicher Eingabe kann mittels  <Bold> .Value </Bold>  auf das Ergebnis zugegriffen werden.
Im Falle der Einzelselektion gibt es noch 2 zus&#228;tzliche Ergebniswerte, den  <Bold> .SelectionPoint </Bold>  und die  <Bold> SelectedGeometry </Bold> . Der SelectionPoint beschreibt die Koordinate, mit welcher das Objekt beim Klick selektiert wurde, die SelectedGeometry gibt die jeweilige Basisgeometrie zur&#252;ck bei welcher das Objekt gew&#228;hlt wurde (zB. ein Segment).

 <Bold> Einzelselektion </Bold> 

```
res = Application.IO.GetObject(&#39;Bitte w&#228;hlen Sie ein Objekt:&#39;)

#SelectionPoint ermitteln
print res.SelectionPoint
print res.SelectedGeometry

```


 <Bold> Mehrfachselektion </Bold> 

```
hinweisText = &#39;Bitte w&#228;hlen Sie ein Einzelobjekt per Mausklick oder mehrere Objekte per Angabe eines Fenster-Bereichs:&#39;
Application.IO.GetObjects(hinweisText)
```


 <Bold> Selektion mit Objektklassenfilter </Bold> 

```
#Filterung auf LineString Objekte (Mehrfachauswahl)
Application.IO.GetObjects(&#39;Objekte ausw&#228;hlen:&#39;, &#39;LineString&#39;)
#Filter auf LineString oder Point Objekte (Mehrfachauswahl)
Application.IO.GetObjects(&#39;Objekte ausw&#228;hlen:&#39;, [&#39;LineString&#39;,&#39;Point&#39;])

#Filterung auf LineString Objekte (Einzelauswahl)
Application.IO.GetObject(&#39;Objekt ausw&#228;hlen:&#39;, &#39;LineString&#39;)
#Filter auf LineString oder Point Objekte (Einzelauswahl)
Application.IO.GetObject(&#39;Objekt ausw&#228;hlen:&#39;, [&#39;LineString&#39;,&#39;Point&#39;])

```


### Fensterselektion
Das Attribut  <Italic> Application.IO </Italic>  erm&#246;glicht auch die Abfrage eines Fenster-Bereichs vom Anwender unter Angabe einer Eingabeaufforderung.
&#220;ber die Eigenschaft  <Bold> .Ok </Bold>  des Ergebnisses kann gepr&#252;ft werden, ob die Eingabe erfolgreich durchgef&#252;hrt wurde.
Bei erfolgreicher Eingabe kann mittels  <Bold> .Value </Bold>  auf die Koordinaten des gew&#228;hlten Bereichs in Form einer  <Bold> Liste von Tuples </Bold>   zugegriffen werden.

```
text = &#39;Bitte w&#228;hlen Sie ein Fenster aus:&#39;
abfrage = Application.IO.GetWindow(text)
if abfrage.Ok:
    print abfrage.Value
    print abfrage.Value[0]
    print abfrage.Value[1]
```


### Vorselektierte Objekte
Die Methode  <Bold> Application.IO.GetInitialSelection </Bold>  erm&#246;glicht das Auslesen der zum Zeitpunkt des Script-Starts selektierten Objekte.


```

#Gibt alle zum Script-Start gew&#228;hlten Punkt-Ids aus
for obj in Application.IO.GetInitialSelection().WhereObjectClass(&#39;Point&#39;) :
    print obj.Id
```


### Grafische Selektion l&#246;schen
Die Methode  <Bold> Application.IO.ClearSelection </Bold>  hebt die Auswahl der bis zu ihrem Aufruf in der Grafik selektierten Objekte auf.

<Success>
Die Selektion inmitten einer Eingabeaufforderung an den Benutzer kann hiermit nicht beeinflusst werden, sondern lediglich Befehle, die eine grafische Selektion zur&#252;cklassen.
</Success>


```

#Aufheben der Selektion in der Grafik
Application.IO.ClearSelection()
```


### Grafische Selektion abfragen bzw. setzen
Mit der Methode  <Bold> Application.IO.GetSelection </Bold>  fragen Sie die aktuell selektierten Modellobjekte ab. Das Ergebnis k&#246;nnen Sie wie gewohnt auch weiter filtern.

Die Funktion  <Bold> Appliction.IO.SetSelection </Bold>  wiederum erm&#246;glicht es, eine Reihe von Objekten in der Grafik zu selektieren. In Kombination ergeben sich verschiedene M&#246;glichkeiten, Mengen f&#252;r den n&#228;chsten Befehl zu bilden.


```

#Punkte aus Benutzerselektion holen und nur diese selektieren
liste=[]
for obj in Application.IO.GetObjects(&#39;Objekte ausw&#228;hlen:&#39;).Value:
    if obj.ObjectClass  &#39;Point&#39;:
        liste.append(obj)
print &#39;Extrahiere&#39;,len(liste),&#39; Punkte aus Selektion...&#39;
Application.IO.SetSelection(liste)
# Bearbeitung der gesetzten Selektion...
# ...
print &#39;L&#246;sche Selektion (Tastendruck)&#39;
Application.IO.GetString(&#39;Taste zum Fortfahren.&#39;)
Application.IO.SetSelection([]) #alternativ .ClearSelection()

```

