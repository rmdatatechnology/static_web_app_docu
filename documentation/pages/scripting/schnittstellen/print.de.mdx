---
title: "Print"
page: true
---
## Das Attribut  <Bold> Application.Print </Bold>  stellt Methoden zum Steuern des Druckwizzards und zum Gestalten der Layouts zur Verf&#252;gung.

### Aktuelle Layouts ermitteln und ein bestehendes Layout laden

```

#print Application.Print.GetAllHeaderLayouts()
layoutlist = Application.Print.GetAllPrintLayouts()
myfilename=layoutlist[&quot;RoamingFolder:Plankopflayout&quot;]
mylayout= Application.Print.LoadLayoutFromFile(myfilename)

```

Es k&#246;nnen die aktuell verf&#252;gbaren Drucklayouts bzw. Plankopflayouts ermittelt werden.
Ergebnis ist ein Dictionary mit dem Schl&#252;ssel [Herkunft:Name], welches die Pfade der Layouts enth&#228;lt.
Danach kann das Layout-Objekt geladen werden.

### Neues Layout erzeugen

```

name=&quot;Streifenplan&quot;
width=210
height=297
mynewlayout = Application.Print.PrintLayoutNew(name,width,height)

```

Es wird ein neues Layout mit der vorgegebenen Breite und H&#246;he erzeugt.

### Neuen Druckbereich erzeugen

```

geom=[(0,0),(0,297), (210,297), (210,0)]
mynewprintregeion = Application.Print.PrintRegionNew(geom)

```

Es wird ein neuer Druckbereich mit der angegebenen Gr&#246;&#223;e (in mm) erstellt. 
Die Reihenfolge der Punkte muss links unten beginnen und im Uhrzeigersinn angegeben werden

### Lesen der Druckbereiche eines Layouts

```

printRegions = Application.Print.GetPrintRegionsFromPrintLayout(printLayout)
print printRegions[&quot;Name1&quot;]

```

Es werden alle Druckbereiche des Layouts zur&#252;ckgegeben, der Zugriff erfolgt &#252;ber den Namen des Druckbereichs.

### Zuordnen eines Layout-Elementes (z.B. Druckbereich) zu einem Layout

```

printLayout = mynewlayout
elementId=&quot;Druckbereich1&quot;
layoutElement =mynewprintregeion
moveVector = None
moveVector = (50,50) # in mm
Application.Print.AddElementToPrintLayout(printLayout,elementId,layoutElement,moveVector)

```


### Zuordnen mehrerer Layout-Elemente zu einem Layout

```

myheaderlayoutlist = Application.Print.GetAllHeaderLayouts()
myfilename=myheaderlayoutlist[&quot;RoamingFolder:Plankopflayout&quot;]
myheaderlayout= Application.Print.LoadLayoutFromFile(myfilename)
layoutElements=myheaderlayout.LayoutElements
Application.Print.AddElementsToPrintLayout(printLayout,layoutElements,moveVector)

```

Auslesen der Elemente eines Planlayouts
Zuordnen der Elemente zum Drucklayout bzw. zum Druckbereich (Nordpfeil, Ma&#223;stabsleiste, Ma&#223;stab,...)
Diese Funktion setzt ein Drucklayout mit genau einem Druckbereich voraus, dem die Elemente zugeordnet werden k&#246;nnen.

### Speichern von Linien und Texten in einem Layout
Ein bestehendes Printlayout kann um Texte oder Linienz&#252;ge erg&#228;nzt werden.
Das neue Printlayout wird im Dateisystem gespeichert.
Die Druckmethode verwendet das neue Printlayout f&#252;r den Ausdruck.

```

myprintlayout= Application.Print.LoadLayoutFromFile(&#39;C:\\Temp\\test.printlayout&#39;)
mylinestring=Application.Print.ElementLineNew([(10,10),(20,20)])
mytext=Application.Print.ElementTextNew(&#39;NeuerText&#39;,(20,20))
mytext=Application.Print.ElementTextNew(textValue,geom,angle,size,font,isBold,isItalic,isUnderlined,alignment)

Application.Print.AddElementToPrintLayout(myprintlayout,&#39;105&#39;,mylinestring,None)
Application.Print.AddElementToPrintLayout(myprintlayout,&#39;110&#39;,mytext,None)
Application.Print.SaveLayoutToFile(myprintlayout,&#39;C:\\Temp\\test1.printlayout&#39;)

p=Application.Print.PrintSettingsNew()
p.PrinterName = &quot;PDFCreator&quot;
p.PrintLayoutPath = &#39;C:\\Temp\\test1.printlayout&#39;
p.PrintRegionCoordinates = {&quot;Druckbereich1&quot;: (-22646,295773)
p.PaperName = &quot;A1&quot;
Application.Print.StartPrint(p)

```

Werte f&#252;r alignment: &#39;TopLeft&#39;,&#39;TopCenter&#39;,&#39;TopRight&#39;,&#39;MiddleLeft&#39;,&#39;MiddleCenter&#39;,&#39;MiddleRight&#39;,&#39;BottomLeft&#39;,&#39;BottomCenter&#39;,&#39;BottomRight&#39;,&#39;BaseLeft&#39;,&#39;BaseCenter&#39;,&#39;BaseRight&#39;

### Speichern von Hektarnetzmarken in einem Layout
Ein neu erstelltes Printlayout kann um Hektarnetzmarken erweitert werden.
Es wird im Code das Printlayout sowie der Druckbereich definiert.
Dem Druckbereich werden dann die Hektarnetzmarken zugeordnet.

```

myprintlayout=Application.Print.PrintLayoutNew(&#39;Neues Layout&#39;,210,297)
myprintregion=Application.Print.PrintRegionNew([(5, 5), (205, 5), (205,292), (5,292), (5,5)])

#Erzeugt Hektarmarken als Linien &#252;ber den Druckbereich
mygrid=Application.Print.ElementGridNew()
mygrid.Distance=20 #Distanz (cm)
mygrid.ShowLabelsState=2 #Beschriftung am Rand: 0=Off 1=OnOutside 2=OnInside

#Erzeugt Hektarmarken als Markierungen im Druckbereich mit entsprechenden Beschriftungsoptionen
pointlength=5 #Symbolgr&#246;&#223;e der Hektarmarken
showLabels=True #Beschriftungen anzeigen
areLabelsInside=False #Beschriftungen innen oder au&#223;en
mygrid=Application.Print.ElementGridIntersectionNew(pointlength,showLabels,areLabelsInside)

#Erzeugt Hektarmarken als Markierungen im Druckbereich mit entsprechenden Beschriftungsoptionen
#mygrid=Application.Print.ElementGridIntersectionNew(pointlength,showLabels,areLabelsInside,size,font,isBold,isItalic,isUnderlined)

Application.Print.AddElementToPrintRegion(myprintlayout,myprintregion,&#39;10&#39;,mygrid,None)
Application.Print.AddElementToPrintLayout(myprintlayout,&#39;11&#39;,myprintregion,None)
Application.Print.SaveLayoutToFile(myprintlayout,&#39;C:\\Temp\\test1.printlayout&#39;)

```



### Zuordnen eines Layout-Elements (z.B. Nordpfeil) zu einem Druckbereich

```

elementId=&quot;NordpfeilNeu&quot;
layoutElement=myheaderlayout.LayoutElements[&quot;Nordpfeil&quot;]
Application.Print.AddElementToPrintRegion(printLayout,printRegion,elementId,layoutElement,moveVector)

```


### Speichern eines Drucklayouts als Datei

```

Application.Print.SaveLayoutToFile(printLayout,fileName)

```


### Steuern des Druckwizzards

```

p = Application.Print.PrintSettingsNew()
p.PrinterName = &quot;PDFCreator&quot; #Druckername
p.Scale = 500 #Druckma&#223;stab
p.PrintLayoutPath = &#39;C:\\ProgramData\\rmDATA\\GeoDesktop\\Templates\\Printing\\A4-Quer (&#220;bersicht) - test.PrintLayout&#39;
p.PrintRegionCoordinates = {&quot;Druckbereich1&quot;: (1250.23,240001.17)
p.Landscape = True #Querformat, False f&#252;r Hochformat
p.PaperName = &quot;A4&quot; #Papiergr&#246;&#223;e laut Druckerangaben
p.Parameters = {&quot;DocumentName&quot;: &quot;Testdocument&quot;,&quot;CurrentDate&quot;: &quot;123456&quot;,&quot;freiesAttribut&quot;: &quot;Testattributwert&quot;
p.PlotStylePath = &quot;C:\\ProgramData\\rmDATA\\GeoDesktop\\Templates\\Printing\\Linienst&#228;rke_25.PlotStyle&quot; 
p.PrintTransparency= True #Drucken der Transparenz
p.PrintWithClipping = False #Nur notwendige Daten drucken

#Starten des Druckvorgangs
printok = Application.Print.StartPrint(p)

```

Es wird der Druckwizzard gestartet, die Einstellungen gesetzt und die Druckvorschau angezeigt.
Wird der Druckwizzard mit OK beendet, gibt printok=True zur&#252;ck.
